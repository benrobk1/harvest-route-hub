# Mobile App Guide

**Last Updated**: November 2025  
**Project Type**: PWA + Native Capacitor Support

## Overview

Blue Harvests supports both Progressive Web App (PWA) and native mobile deployment through Capacitor, giving you flexibility in distribution and device feature access.

## Progressive Web App (PWA)

### Features

- **Installable**: Users can install the app on their home screen
- **Offline Support**: Basic functionality works offline
- **Fast Loading**: Cached assets for quick page loads
- **App-like Experience**: Full screen, no browser UI

### User Installation

Visit `/install` on your device for platform-specific instructions:

**iPhone/iPad:**
1. Open the app in Safari
2. Tap the Share button (square with arrow)
3. Scroll down and tap "Add to Home Screen"
4. Tap "Add"

**Android:**
1. Open the app in Chrome
2. Tap the menu (three dots)
3. Tap "Install app" or "Add to Home screen"
4. Tap "Install"

### PWA Configuration

The PWA is configured in `vite-pwa.config.ts`:

- **Icons**: 192x192 and 512x512 PNG icons in `/public`
- **Manifest**: App name, theme color, display mode
- **Service Worker**: Auto-generated by Vite PWA plugin
- **Caching**: Network-first strategy for API calls, cache-first for assets

### Offline Capabilities

The app caches:
- Static assets (JS, CSS, images)
- API responses (24-hour cache)
- Product listings
- User profile data

Network-first strategy ensures fresh data when online, falls back to cache when offline.

### Testing PWA

1. Build the app: `npm run build`
2. Preview: `npm run preview`
3. Open in browser and verify:
   - Install prompt appears
   - Service worker registers
   - Offline mode works
   - Assets cache properly

### Customizing PWA

**Update Icons:**
Replace in `/public`:
- `pwa-192x192.png` - Small icon for Android
- `pwa-512x512.png` - Large icon and splash screen

**Update Manifest:**
Edit `vite-pwa.config.ts`:
```typescript
manifest: {
  name: 'Your App Name',
  short_name: 'Short Name',
  description: 'Your app description',
  theme_color: '#your-color',
  background_color: '#your-color',
  display: 'standalone', // or 'fullscreen', 'minimal-ui'
  orientation: 'portrait', // or 'landscape'
  start_url: '/',
}
```

## Native Mobile (Capacitor)

### Prerequisites

- **iOS**: Mac with Xcode installed
- **Android**: Android Studio installed
- Node.js and npm installed

### Setup Instructions

#### 1. Transfer to GitHub

Click the "Export to Github" button in Lovable to transfer your project to your own GitHub repository, then clone it locally:

```bash
git clone <your-repo-url>
cd harvest-route-hub
```

#### 2. Install Dependencies

```bash
npm install
```

#### 3. Add Native Platforms

**iOS:**
```bash
npx cap add ios
npx cap update ios
```

**Android:**
```bash
npx cap add android
npx cap update android
```

#### 4. Build and Sync

```bash
# Build the web app
npm run build

# Sync to native platforms
npx cap sync
```

**Important**: Run `npx cap sync` after every `git pull` to sync changes to the native platforms.

#### 5. Run on Device/Emulator

**Android:**
```bash
npx cap run android
```

**iOS (Mac only):**
```bash
npx cap run ios
```

### Development Workflow

1. Make changes in Lovable
2. Git pull the latest changes
3. Run `npx cap sync` to sync changes
4. Test on your device/emulator

### Hot Reload

The app is configured to hot-reload from the Lovable sandbox URL. This means you can see changes instantly without rebuilding the native app during development.

### Native Features Available

- üì∏ Camera access
- üîî Push notifications
- üìç GPS/Location services
- üìÇ File system access
- üé§ Microphone access
- üì± Device information
- üîã Battery status
- And much more!

### Publishing to App Stores

#### iOS App Store

1. Open the project in Xcode: `npx cap open ios`
2. Configure signing & capabilities
3. Archive and upload to App Store Connect

#### Google Play Store

1. Open the project in Android Studio: `npx cap open android`
2. Generate signed APK/Bundle
3. Upload to Google Play Console

For detailed publishing guides:
- [iOS Publishing Guide](https://capacitorjs.com/docs/ios/deploying-to-app-store)
- [Android Publishing Guide](https://capacitorjs.com/docs/android/deploying-to-google-play)

## Browser Support

### PWA Support
- Chrome/Edge: Full support
- Safari iOS: Full support (iOS 11.3+)
- Firefox: Full support
- Samsung Internet: Full support

### Native Support
- iOS: 12.0+
- Android: 5.0+ (API level 21+)

## Troubleshooting

### PWA Issues

**Install prompt not showing:**
- Verify HTTPS is enabled
- Check manifest.json is valid
- Ensure service worker is registering
- Clear browser cache and try again

**Offline mode not working:**
- Check service worker is active
- Verify caching strategy in `vite-pwa.config.ts`
- Test with DevTools ‚Üí Application ‚Üí Service Workers

### Capacitor Issues

**Build fails:**
- Ensure all dependencies are installed
- Run `npm run build` before `npx cap sync`
- Check native platform tools are installed (Xcode/Android Studio)

**Hot reload not working:**
- Verify `capacitor.config.ts` has correct server URL
- Check device and dev machine are on same network
- Restart development server

## Resources

- [Capacitor Documentation](https://capacitorjs.com/docs)
- [PWA Documentation](https://web.dev/progressive-web-apps/)
- [Lovable Discord Community](https://discord.com/channels/1119885301872070706/1280461670979993613)
- [Capacitor Blog Post](https://lovable.dev/blog/capacitor-mobile-app-development)

## Related Documentation

- [Deployment Checklist](./DEPLOYMENT-CHECKLIST.md)
- [Architecture Guide](../ARCHITECTURE.md)
- [Testing Guide](./TESTING.md)
